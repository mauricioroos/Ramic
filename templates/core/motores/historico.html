{% extends "core/base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h3 class="mb-0">Histórico de Acionamentos</h3>
    {% if motor %}<small class="text-muted">Histórico de: {{ motor.nome }}</small>{% endif %}
  </div>
  <div class="d-flex gap-2">
    <a href="{% url 'exportar_historico_txt' %}" class="btn btn-secondary">Exportar Histórico</a>
    <a href="{% url 'painel' %}" class="btn btn-primary">Voltar</a>
  </div>
</div>

<div class="table-responsive card card-body">
  <table class="table table-striped table-hover align-middle mb-0">
    <thead>
      <tr>
        <th>Motor</th>
        <th>Usuário</th>
        <th>Data</th>
        <th>Hora</th>
        <th>Ação</th>
      </tr>
    </thead>
    <tbody>
      {% for log in logs %}
      <tr>
        <td>{{ log.motor.nome }}</td>
        <td>{{ log.usuario.username }}</td>
        <td>{{ log.timestamp|date:"d/m/Y" }}</td>
        <td>{{ log.timestamp|time:"H:i:s" }}</td>
        <td>
          {% if log.acao == "LIGADO" %}
            <span class="badge text-bg-success">{{ log.get_acao_display }}</span>
          {% elif log.acao == "DESLIGADO" %}
            <span class="badge text-bg-danger">{{ log.get_acao_display }}</span>
          {% elif log.acao == "MANUTENCAO_INICIO" %}
            <span class="badge text-bg-warning">Manutenção Iniciada</span>
          {% elif log.acao == "MANUTENCAO_FIM" %}
            <span class="badge text-bg-info">Manutenção Finalizada</span>
          {% else %}
            <span class="badge text-bg-secondary">{{ log.acao }}</span>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-center p-4">Sem registros ainda.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}